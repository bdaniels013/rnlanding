<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Secure Checkout — Rich Nick</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
    <style>
      :root { --bg:#0b0f1a; --card: rgba(255,255,255,.05); --b:#1f2937; --accent1:#6366f1; --accent2:#db2777; }
      *{box-sizing:border-box}
      body{margin:0; font-family:Inter,system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; background:var(--bg); color:#fff}
      .wrap{max-width:880px;margin:24px auto;padding:20px}
      .card{background:var(--card);border:1px solid rgba(255,255,255,.1);border-radius:16px;padding:24px;backdrop-filter: blur(6px)}
      .grid{display:grid;grid-template-columns:1fr;gap:16px}
      @media(min-width:900px){.grid{grid-template-columns:1.25fr .75fr}}
      .btn{display:inline-flex;align-items:center;justify-content:center;padding:14px 16px;border-radius:12px;border:0;background:linear-gradient(90deg,var(--accent1),var(--accent2));color:#fff;font-weight:600;cursor:pointer;width:100%}
      .h{margin:0 0 8px}
      .muted{color:#b8c}
      input,select{width:100%;padding:12px 14px;border-radius:12px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);color:#fff}
      label{font-size:12px;color:#aab;margin-bottom:6px;display:block}
      .row{display:grid;grid-template-columns:1fr;gap:12px}
      @media(min-width:700px){.row{grid-template-columns:1fr 1fr}}
    </style>
  </head>
  <body>
    <div class="wrap">
      <div style="margin-bottom:16px">
        <a href="/" style="text-decoration:none; display:inline-block;">
          <img src="/assets/richhnicklogo.jpg" alt="Rich Nick" style="height:36px;border-radius:8px; cursor:pointer; transition:opacity 0.2s;" onmouseover="this.style.opacity='0.8'" onmouseout="this.style.opacity='1'"/>
        </a>
      </div>
      <h1 class="h">Secure Checkout</h1>
      <p class="muted">You’ll be redirected to our gateway’s hosted page to enter your payment securely.</p>

      <div class="grid">
        <div class="card">
          <div style="display:flex; align-items:center; justify-content:space-between; margin-bottom:16px;">
            <h3 class="h" style="margin:0;">Your details</h3>
            <a href="/" style="display:inline-flex; align-items:center; gap:6px; padding:8px 12px; background:rgba(255,255,255,.1); border:1px solid rgba(255,255,255,.2); border-radius:8px; color:#fff; text-decoration:none; font-size:14px; transition:all 0.2s;" onmouseover="this.style.background='rgba(255,255,255,.15)'" onmouseout="this.style.background='rgba(255,255,255,.1)'">
              ← Go Back
            </a>
          </div>
          <form id="prefill-form">
            <div class="row">
              <div>
                <label>Full name</label>
                <input id="name" placeholder="Jane Doe" />
              </div>
              <div>
                <label>Email</label>
                <input id="email" type="email" placeholder="jane@example.com" />
              </div>
            </div>
            <div class="row">
              <div>
                <label>Phone</label>
                <input id="phone" type="tel" placeholder="(555) 123-4567" />
              </div>
              <div></div>
            </div>
            <div class="row">
              <div>
                <label>Offer</label>
                <select id="offer">
                  <option value="">Loading offers...</option>
                </select>
              </div>
              <div>
                <label>Amount</label>
                <input id="amount" type="text" readonly style="background:rgba(255,255,255,.03); color:#888; cursor:not-allowed;" />
              </div>
            </div>
            <div style="height:10px"></div>
            <button class="btn" type="submit">Continue — Secure Hosted Payment</button>
            <div style="height:8px"></div>
            <a href="/" style="display:block; text-align:center; color:#aab; text-decoration:none; font-size:14px; padding:8px; border-radius:8px; transition:all 0.2s;" onmouseover="this.style.background='rgba(255,255,255,.05)'" onmouseout="this.style.background='transparent'">
              ← Back to Home
            </a>
          </form>
        </div>
        <div class="card">
          <h3 class="h">Order Summary</h3>
          <div id="summary" class="muted">Monthly Creator Pass — $1,000.00</div>
          <div style="height:10px"></div>
          <div class="muted" style="font-size:12px">No card data is entered on this site. You’ll complete payment on our PCI‑compliant gateway (NMI) and be returned here with your receipt.</div>
          <div style="height:16px"></div>
          <div style="display:flex;gap:10px;align-items:center;opacity:.85">
            <svg width="56" height="18" viewBox="0 0 80 26" xmlns="http://www.w3.org/2000/svg" aria-label="Visa"><rect width="80" height="26" rx="6" fill="#0b0f1a"/><text x="12" y="17" fill="#6ea8ff" font-family="Helvetica, Arial, sans-serif" font-size="14" font-weight="700">VISA</text></svg>
            <svg width="56" height="18" viewBox="0 0 80 26" xmlns="http://www.w3.org/2000/svg" aria-label="Mastercard"><rect width="80" height="26" rx="6" fill="#0b0f1a"/><circle cx="33" cy="13" r="7" fill="#ff5f45"/><circle cx="41" cy="13" r="7" fill="#ffb14a" fill-opacity="0.9"/><text x="50" y="17" fill="#e5e7eb" font-family="Helvetica, Arial" font-size="10">MC</text></svg>
            <svg width="56" height="18" viewBox="0 0 80 26" xmlns="http://www.w3.org/2000/svg" aria-label="American Express"><rect width="80" height="26" rx="6" fill="#0b0f1a"/><rect x="8" y="6" width="28" height="14" rx="3" fill="#3b82f6"/><text x="13" y="16" fill="#fff" font-family="Helvetica, Arial" font-size="10" font-weight="700">AMEX</text></svg>
            <svg width="72" height="18" viewBox="0 0 96 26" xmlns="http://www.w3.org/2000/svg" aria-label="Discover"><rect width="96" height="26" rx="6" fill="#0b0f1a"/><circle cx="48" cy="13" r="6" fill="#fb923c"/><text x="12" y="17" fill="#e5e7eb" font-family="Helvetica, Arial" font-size="12" font-weight="700">DISCOVER</text></svg>
          </div>
        </div>
      </div>
    </div>
    <script>
      const form = document.getElementById('prefill-form');
      const offer = document.getElementById('offer');
      const amount = document.getElementById('amount');
      const name = document.getElementById('name');
      const email = document.getElementById('email');
      const phone = document.getElementById('phone');
      const summary = document.getElementById('summary');
      let offers = [];

      // Load offers from API
      async function loadOffers() {
        try {
          const response = await fetch('/api/offers');
          offers = await response.json();
          
          // Clear existing options
          offer.innerHTML = '';
          
          // Add offers to dropdown
          offers.forEach((offerData, index) => {
            const option = document.createElement('option');
            option.value = offerData.sku;
            option.textContent = `${offerData.name} — $${(offerData.priceCents / 100).toLocaleString()}`;
            if (index === 0) option.selected = true;
            offer.appendChild(option);
          });
          
          // Set initial amount for first offer
          if (offers.length > 0) {
            amount.value = `$${(offers[0].priceCents / 100).toLocaleString()}`;
          }
          
          updateSummary();
        } catch (error) {
          console.error('Failed to load offers:', error);
          offer.innerHTML = '<option value="">Error loading offers</option>';
          amount.value = 'Error loading offers';
        }
      }

      function updateSummary(){
        if (offer.selectedIndex >= 0) {
          summary.textContent = `${offer.options[offer.selectedIndex].text}`;
        }
      }

      function syncAmountWithOffer() {
        const selectedOffer = offers.find(o => o.sku === offer.value);
        if (selectedOffer) {
          amount.value = `$${(selectedOffer.priceCents / 100).toLocaleString()}`;
        }
      }

      offer.addEventListener('change', () => {
        syncAmountWithOffer();
        updateSummary();
      });

      form.addEventListener('submit', (e) => {
        e.preventDefault();
        if (!offer.value) {
          alert('Please select an offer');
          return;
        }
        const selectedOffer = offers.find(o => o.sku === offer.value);
        if (!selectedOffer) {
          alert('Please select a valid offer');
          return;
        }
        const params = new URLSearchParams({
          amount_cents: selectedOffer.priceCents,
          offer_id: offer.value,
          name: name.value,
          email: email.value,
          phone: phone.value
        }).toString();
        window.location.href = `/api/payment-cloud/hpp/start?${params}`;
      });

      // Load offers when page loads
      loadOffers();
    </script>
    <div style="max-width:880px;margin:16px auto 32px;padding:0 20px;color:#9aa; font-size:11px;">
      <div>Rich Nick Growth LLC • 750 Forest Park Ln., Suwanee, GA 30024 • (813) 476-0044</div>
      <div style="margin-top: 8px;">
        <a href="/terms" style="color:#9aa; text-decoration:underline;">Terms and Conditions</a> • 
        <a href="/refund-policy" style="color:#9aa; text-decoration:underline;">Refund Policy</a> • 
        <a href="/privacy" style="color:#9aa; text-decoration:underline;">Privacy Policy</a>
      </div>
    </div>
  </body>
  </html>


